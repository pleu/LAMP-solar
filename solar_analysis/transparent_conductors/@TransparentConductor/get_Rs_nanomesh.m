function [tc] = get_Rs_nanomesh(tc)
%GET_RS_NANOMESH Get sheet resistance of nanomesh by interpolation

% The thickness of the thin film in the FEA simulation was 20 nm
thickness_table = 20;

% Column 1 - pitch, column 2 - diameter, column 3 - average sheet resistance
Rs_table = [100	50	1.04E+00
150	50	9.17E-01
150	100	1.26E+00
200	50	8.78E-01
200	100	1.04E+00
200	150	1.45E+00
250	50	8.60E-01
250	100	9.56E-01
250	150	1.16E+00
250	200	1.60E+00
300	50	8.52E-01
300	100	9.15E-01
300	150	1.04E+00
300	200	1.27E+00
300	250	1.74E+00
350	50	8.46E-01
350	100	8.92E-01
350	150	9.80E-01
350	200	1.12E+00
350	250	1.36E+00
350	300	1.86E+00
400	50	8.43E-01
400	100	8.77E-01
400	150	9.42E-01
400	200	1.04E+00
400	250	1.20E+00
400	300	1.45E+00
400	350	1.98E+00
450	50	8.40E-01
450	100	8.66E-01
450	150	9.18E-01
450	200	9.94E-01
450	250	1.11E+00
450	300	1.27E+00
450	350	1.53E+00
450	400	2.08E+00
500	50	8.39E-01
500	100	8.59E-01
500	150	9.00E-01
500	200	9.61E-01
500	250	1.05E+00
500	300	1.16E+00
500	350	1.33E+00
500	400	1.61E+00
500	450	2.18E+00
550	50	8.38E-01
550	100	8.55E-01
550	150	8.89E-01
550	200	9.37E-01
550	250	1.00E+00
550	300	1.10E+00
550	350	1.22E+00
550	400	1.40E+00
550	450	1.68E+00
550	500	2.27E+00
600	50	8.37E-01
600	100	8.51E-01
600	150	8.79E-01
600	200	9.19E-01
600	250	9.74E-01
600	300	1.05E+00
600	350	1.14E+00
600	400	1.27E+00
600	450	1.45E+00
600	500	1.75E+00
600	550	2.35E+00
650	50	8.36E-01
650	100	8.48E-01
650	150	8.72E-01
650	200	9.06E-01
650	250	9.51E-01
650	300	1.01E+00
650	350	1.09E+00
650	400	1.19E+00
650	450	1.32E+00
650	500	1.51E+00
650	550	1.81E+00
650	600	2.44E+00
700	50	8.36E-01
700	100	8.46E-01
700	150	8.67E-01
700	200	8.95E-01
700	250	9.34E-01
700	300	9.84E-01
700	350	1.05E+00
700	400	1.13E+00
700	450	1.23E+00
700	500	1.37E+00
700	550	1.56E+00
700	600	1.87E+00
700	650	2.52E+00
750	50	8.35E-01
750	100	8.45E-01
750	150	8.62E-01
750	200	8.87E-01
750	250	9.20E-01
750	300	9.63E-01
750	350	1.02E+00
750	400	1.08E+00
750	450	1.17E+00
750	500	1.27E+00
750	550	1.41E+00
750	600	1.61E+00
750	650	1.93E+00
750	700	2.59E+00
800	50	8.35E-01
800	100	8.43E-01
800	150	8.58E-01
800	200	8.80E-01
800	250	9.09E-01
800	300	9.46E-01
800	350	9.91E-01
800	400	1.05E+00
800	450	1.12E+00
800	500	1.20E+00
800	550	1.31E+00
800	600	1.46E+00
800	650	1.66E+00
800	700	1.98E+00
800	750	2.66E+00
850	50	8.35E-01
850	100	8.41E-01
850	150	8.55E-01
850	200	8.75E-01
850	250	9.00E-01
850	300	9.32E-01
850	350	9.71E-01
850	400	1.02E+00
850	450	1.08E+00
850	500	1.15E+00
850	550	1.24E+00
850	600	1.35E+00
850	650	1.50E+00
850	700	1.70E+00
850	750	2.03E+00
850	800	2.73E+00
900	50	8.34E-01
900	100	8.41E-01
900	150	8.53E-01
900	200	8.70E-01
900	250	8.93E-01
900	300	9.21E-01
900	350	9.55E-01
900	400	9.97E-01
900	450	1.05E+00
900	500	1.11E+00
900	550	1.18E+00
900	600	1.27E+00
900	650	1.39E+00
900	700	1.54E+00
900	750	1.75E+00
900	800	2.08E+00
900	850	2.80E+00
950	50	8.34E-01
950	100	8.40E-01
950	150	8.51E-01
950	200	8.66E-01
950	250	8.86E-01
950	300	9.12E-01
950	350	9.42E-01
950	400	9.79E-01
950	450	1.02E+00
950	500	1.08E+00
950	550	1.14E+00
950	600	1.21E+00
950	650	1.31E+00
950	700	1.42E+00
950	750	1.58E+00
950	800	1.79E+00
950	850	2.13E+00
950	900	2.87E+00
1000	50	8.34E-01
1000	100	8.39E-01
1000	150	8.49E-01
1000	200	8.63E-01
1000	250	8.81E-01
1000	300	9.03E-01
1000	350	9.31E-01
1000	400	9.63E-01
1000	450	1.00E+00
1000	500	1.05E+00
1000	550	1.10E+00
1000	600	1.17E+00
1000	650	1.24E+00
1000	700	1.34E+00
1000	750	1.46E+00
1000	800	1.61E+00
1000	850	1.83E+00
1000	900	2.18E+00
1000	950	2.93E+00];

% Test the interpolation
% Rs_table = [700 660 222;800 550 223;900 700 222];

p = Rs_table(:,1);
d = Rs_table(:,2);
Rs = Rs_table(:,3);
F = TriScatteredInterp(p,d,Rs);
Rs_interp = F(tc.Structure.Pitch,tc.Structure.Shape.Diameter);
tc.SheetResistance = Rs_interp * thickness_table / tc.Structure.Shape.Thickness;

end

